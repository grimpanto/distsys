
\chapter{Grundlagen und Basiskonzepte}

In diesem Kapitel werden die Grundlagen und Basiskonzepte der Rechernetze
dargestellt. Diese Konzepte kommen alle auch im größeren Zusammenhang
der Entwicklung verteilter Systeme vor.

Prinzipiell lässt sich sagen, dass diese Konzepte meistens in verschiedenen
Sichtweisen und Anwendungsfällen vorkommen. Z.B. treten sie entweder
auf einer logischen oder einer physischen Ebene auf oder sie betreffen
entweder die Hardware oder die Software.

Eine Definition der grundlegenden Konzepte ermöglicht es uns, diese
für die Erläuterungen der Grundlagen der Rechnernetze, der Beschreibung
der Anwendungen von Rechnernetzen als auch der Entwicklung von verteilten
Systemen konsistent anzuwenden. Es ermöglicht hiermit eine klare Beschreibung
der weitergehenden Konzepte.


\section{Grundlegende Begriffe}
\begin{description}
\item [{System}] Wir verstehen unter einem System eine abgegrenzte oder
abgrenzbare Menge von Elementen, die miteinander in Relationen stehen.
Die Struktur des Systems ergibt sich aus der Gesamtheit aller Relationen
zwischen den Elementen, aus denen globale Systemeigenschaften entstehen.


Ein System lässt sich durch die Definition einer Systemgrenze von
seiner Umwelt abgrenzen. Diese Systemgrenze stellt die Schnittstelle
zur Umwelt dar.

Zur weiteren Strukturierung lässt sich ein System in Subsysteme unterteilen.
Ein Subsystem ergibt sich damit aus der Zusammenfassung mehrerer Elemente,
die zusammen die Schnittstelle des Subsystems definieren und bereitstellen.
Ein Subsystem kann wiederum in weitere Subsysteme und Elemente gegliedert
sein.

\item [{Komponente}] Eine Komponente (engl. component) ist eine \emph{austauschbares}
Element in einem System, das ihre innere Struktur nach außen kapselt
und ihre öffentliche Funktionalität über Schnittstellen zur Verfügung
stellt. Damit ist eine Komponente unabhängig verwendbar.
\item [{Objekt}] Unter einem Objekt versteht man allgemein einen Gegenstand
oder das Ziel des Denkens oder Handelns. In der objekt-orientierten
Programmierung versteht man darunter ein Element, das zur Laufzeit
existiert. Objekte sind die Basisbausteine eines Programmes, die Nachrichten
empfangen, Daten verarbeiten und auch selbst Nachrichten versenden
können. Die drei grundlegenden Eigenschaftes eines Programmes sind,
dass jedes Objekt:\end{description}
\begin{itemize}
\item einen Zustand aufweist
\item ein Verhalten hat und
\item eine eindeutige Identität besitzt.\end{itemize}
\begin{description}
\item [{Zerlegung}] Eine Zerlegung (engl. decomposition) eines Problems
in kleinere Teilprobleme stellt in der Regel eine Möglichkeit dar,
die Komplexität des Gesamtproblems besser zu handhaben bzw. sogar
die Komplexität zu verringern. Das Prinzip der Zerlegung wird eben
auch bei Systemen oder Komponenten vorgenommen. In diesem Fall wird
die Gesamtaufgabe in einzelne Teilaufgaben zerlegt, die von bestimmten
Systemen, Komponenten oder Objekten erledigt werden, sodass das Gesamtproblem
gelöst wird.
\item [{Kapselung}] Kapselung (engl. encapsulation oder auch information
hiding) bedeutet, dass die innere Struktur von außen nicht einsehbar
ist.
\item [{Abstraktion}] Bei einer Abstraktion (engl. abstraction) werden
aus einer bestimmten Sicht (engl. view) die wesentlichen Merkmale
(engl. feature) einer »Elementes« (beispielsweise ein Objektes, eine
Komponente oder ein Systems) betrachtet. Abhängig von der Sicht können
ganz unterschiedliche Merkmale abstrahiert werden.


Je nach betrachteter Menge von Merkmalen erhält man daher unterschiedliche
Abstraktionen. Das heißt, dass die Abstraktion von der verwendeten
Sichtweise abhängt.

\item [{Hierarchie}] Eine Hierarchie (engl. hierarchy) stellt eine \emph{geordnete}
Reihenfolge von Abstraktionen dar. D.h., man versucht eine Abstraktion
in weiterer Folge durch eine oder mehrere Abstraktionen weiter zu
verfeinern.
\item [{Schnittstelle}] Die Schnittstelle (engl. interface) definiert detailiert
wie mit einem Element oder einem System interagiert werden kann. Damit
wird einerseits eine Abstraktion festgelegt und andererseits wird
eine Kapselung erreicht (wenn auf das Element nur über ihre Schnittstelle
zugegriffen werden kann).
\item [{Schicht}] Ordnet man mehrere Abstraktionen in einer Hierarchie
an, dann wird jeder Teil dieser Hierarchie eine Schicht genannt. Jede
Schicht dieser Hierarchie hat eine klar definierte Schnittstelle zu
seiner unten angrenzenden Schicht und eine klar definierte Schnittstelle
zu der oben angrenzenden Schicht (siehe \vref{sec:layers}).
\item [{Nachricht}] Eine Nachricht (engl. message) stellt einen Informationsfluss
von einem Kommunikationspartner zum anderen dar. Unter Information
wollen wir hier -- ohne eine Definition anzugeben -- die Struktur
(Syntax), den Inhalt (Semantik) und die Bedeutung (Pragmatik) einer
Nachricht beschreiben. Eine Nachricht wird durch die Auswahl aus einer
Menge von vorgegebenen Möglichkeiten (dem Zeichenvorrat) unter Verwendung
von Regeln (Kodierung) gebildet.


Jede Nachricht wird von einem Sender (der Quelle) über einen Kanal
zu einem Empfänger übertragen (der Senke). 

\item [{Kommunikation}] Elemente kommunizieren miteinander, um gemeinsam
ein bestimmtes Verhalten an den Tag zu legen. Dies erreichen sie dadurch,
dass sie Nachrichten austauschen. Der Austausch der Nachrichten ist
in einem Protokoll festgelegt.
\item [{Protokoll}] Der Austausch von Nachrichten muss gewissen Regeln
entsprechen, damit die Kommunikationspartner einander verstehen. Protokolle
sind präzise Festlegungen aller Regeln (z.B. Abfolge von Nachrichten,
Formate der zu übertragenden Daten, den zeitlichen Einschränkungen,...),
die für eine Kommunikation notwendig sind. D.h. Protokolle definieren
eine Sprache zwischen Kommunikationspartnern.


Protokolle sind der Grund warum Komponenten austauschbar sind: Wenn
beide Kommunikationspartner das Protokoll verstehen, dann sind die
Schnittstellen dieser Kommunikationspartner zueinander kompatibel.
Daher kann eine Komponente durch eine beliebig andere Komponente ersetzt
werden, solange die neue Komponente wieder eine Schnittstelle aufweist,
die zu der Schnittstelle der anderen Komponente kompatibel ist.

\end{description}

\section{Kommunikation\label{sec:communication}}

Der Begriff der Kommunikation als Austausch von Nachrichten stellt
die grundlegende Sichtweise für das Thema der verteilten Systeme dar.
\begin{description}
\item [{Signale}] Auf der pyhsikalischen Ebene werden Nachrichten in Form
von Signalen (elektrisch, optisch, Funk) über eine entsprechendes
Übertragungsmedium versendet. Ein Signal ist die physikalische Darstellungsform
einer Nachricht. Es besteht aus einer diskreten oder kontinuierlichen
Folge von Werten eines Signalparameters (z.B. Spannungswert, Stromwert
oder Feldstärke).
\item [{Kommunikationsrichtung}] Wir unterscheiden zwischen:

\begin{description}
\item [{Simplex}] Nur eine vorgegebene Richtung.
\item [{Half-Duplex}] Ebenfalls nur eine Richtung, aber diese kann sich
ändern.
\item [{Duplex}] Beide Richtungen gleichzeitig.
\end{description}
\item [{Netzprozess}] Unter einem Netzprozess oder kurz Prozess versteht
man eine unabhängige Ausführung eines Programmes im Kontext eines
Rechnernetzes. Zwei oder mehrere Netzprozesse können miteinander kommunizieren
bzw. als Gesamtheit eine Ausführung einer verteilten Anwendung darstellen.
Dabei kann es sich um eine beliebige Anzahl an Hosts handeln, die
einen oder mehrere Betriebssystemprozesse ausführen.
\item [{Anzahl~der~Kommunikationspartner}]~

\begin{description}
\item [{Unicast}] 1:1 Kommunikation.
\item [{Multicast}] 1:n Kommunikation, d.h. Gruppenruf: alle Teilnehmer
einer Gruppe.
\item [{Anycast}] 1:1 Kommunikation, beliebiger Teilnehmer aus einer Gruppe.
\item [{Broadcast}] 1:n Kommunikation allerdings Rundruf: alle Teilnehmer
im Netz.
\end{description}
\item [{Adresse}] Die Fragestellung, die man sich mit einer beliebigen
Anzahl von potenziellen Kommunikationspartnern stellen muss: Wie finden
sich zwei Kommunikationspartner, sodass sie überhaupt miteinander
kommunizieren können? Zur Identifizierung eines Kommunikationsparters
führen wir dazu das Konzept der Adresse ein, die einen Kommunikationspartner
eindeutig identifiziert. Wir gehen vorerst davon aus, dass diese Adresse
bekannt ist und sich auch nicht ändert.
\item [{Rolle}] Man kann oft die beiden Kommunikationspartner einteilen
bzgl. Diensterbringer (engl. service provider) und Dienstnutzer (engl.
service user). Der Diensterbringer wird meistens als Server bezeichnet
und der Dienstnutzer meistens als Client. Der Server bietet einen
gewissen Dienst (engl. service) an, den beliebige Clients nutzen können.
\item [{Art~der~Kommunikation}] Man unterscheidet zwischen verbindungsorientierter
(engl. \linebreak connection-oriented) und verbindungsloser (engl.
connectionless) Kommunikation:

\begin{description}
\item [{verbindungsorientiert}] Eine Verbindung ist eine temporäre Beziehung
zweier Kommunikationspartner zum Zwecke des Datenaustausches. Charakterisiert
ist eine Beziehung dadurch, dass\end{description}
\begin{itemize}
\item eine Verbindung zuerst aufgebaut werden muss. Dann können die Daten
übertragen werden und am Ende wird eine Verbindung wieder abgebaut.
D.h. es gibt 3 Phasen: Verbindungsaufbau (engl. connection establishment),
Datentransfer (engl. data transfer), Verbindungsabbau (engl. connection
release). Der Vorgang des Abbauens einer Verbindung wird oft mit ,,disconnect''
bezeichnet.
\item Verbindungsparameter, die die Übertragung der Daten betreffen, definiert
und ausgehandelt werden.
\item beim Aufbau der Verbindung oft ein Bezeichner (engl. identifier) bereitgestellt
wird, der die Verbindung eindeutig identifiziert und dadurch beim
Datentransfer der Overhead einer etwaigen wiederholten Adressauflösung
und Wegfindung vermieden wird.
\item eine Folge von Nachrichten genau so beim Empfänger ankommen wie sie
der Sender abgesendet hat.\end{itemize}
\begin{description}
\item [{verbindungslos}] Dabei wird jede einzelne Nachricht unabhängig
von vorangehenden oder nachfolgenden Nachrichten versendet.\end{description}
\begin{itemize}
\item Es gibt nur eine Phase, nämlich den Transfer der Daten. Im Zuge der
Übermittlung der Daten werden auch alle -- zur Übertragung notwendinger
Parameter -- mitgegeben.
\item Eine Übertragung wird in der Regel nicht garantiert.
\end{itemize}
\item [{Multiplexen}] Unter Multiplexen (wörtlich: mehrfach) versteht man
das Konzept der gemeinsamen Nutzung einer Systemressource durch mehrere
Nutzer (siehe Abschnitt \linebreak \vref{sec:multiplex}).
\item [{Verbindung}] Eine Verbindung ist eine über einen bestimmten Zeitraum
andauernde Kommunikationsbeziehung, die eine verbindungsorientierte
Kommunikation ermöglicht. Es gibt prinzipiell zwei Arten der Verbindungen:

\begin{description}
\item [{leitungsvermittelt}] Bei der Leitungsvermittlung (engl. circuit
switching) wird eine physikalische Leitung wie z.B. eine Wählleitung
(engl. switched circuit) oder eine Standleitung (engl. leased line)
geschalten (Raummultiplex, siehe Abschnitt\vref{sec:space_division_multiplex})
oder eine virtuelle Leitung mittels synchronem Multiplexen (siehe
Abschnitt\vref{sec:synchronous_multiplex}) aufgebaut.
\item [{paketvermittelt}] Die Paketvermittlung (engl. packet switching)
ist eine Paketübertragung mittels asynchronen Zeitmultiplexverfahren
(siehe Abschnitt\vref{sec:asynchronous_multiplex}) und bildet heute
die Basis für Rechnernetze. Es hat sich hier der Begriff Paket (engl.
packet) etabliert, da entweder eine Nachricht als Pakete aufgefasst
wird bzw. die Nachrichten in einzelne Pakete aufgeteilt werden. Danach
werden die Pakete im asynchronen Zeitmultiplexverfahren übertragen.
In Abschnitt \vref{sec:messages_layers} werden wir den Begriff Paket
noch genauer eingrenzen und im Abschnitt \vref{sec:packet_switching}
die Paketvermittlung noch genauer behandeln.


Eine paketvermittelte Verbindung wird als virtuelle Verbindung (da
eben nicht physikalisch vorhanden) oder auch als logischer Kanal oder
kurz Kanal bezeichnet.

\end{description}
\end{description}

\section{Leistung}

In weiterer Folge werden wir die ,,Übertragungskapazität'' eines
Kanales definieren.


\minisec{Bandbreite und Datenrate}

Als \emph{Bandbreite} (engl. bandwidth) eines Übertragungskanales
verstehen wir die Differenz der oberen Grenzfrequenz und der unteren
Grenzfrequenz eines physikalischen Übertragungskanales. D.h. zwischen
oberer und unterer Grenzfrequenz ist eine Signalübertragung möglich.
Die konventionelle Telefonleitung hat eine untere Grenzfrequenz von
300Hz und eine obere Grenzfrequenz von 3300Hz. Damit übergibt sich
eine Bandbreite von 3000Hz.

In Abhängigkeit der Leitungskodierung (siehe Abschnitt \vref{sec:coding})
ergibt sich eine (Roh-)\emph{Datenrate R} in Bit/s. Aber Achtung:
auch hier wird oft von der Bandbreite gesprochen: ,,Die Bandbreite
einer 10MBit Ethernet-Verbindung beträgt 10MBit/s''.


\minisec{Durchsatz}

Die gemessene Datenrate eines Übertragungskanales wird als \emph{Durchsatz}
(engl. throughput) bezeichnet und wird meistens in Bit/s angegeben.
Zum Beispiel kann der eigentliche Durchsatz auf einer 10MBit Ethernet-Verbindung
in Abhängigkeit von der Anzahl der gleichzeitigen Sender lediglich
2MBit/s betragen.

Aufpassen muss man außerdem, dass in der Regel der Durchsatz eines
logischen Kanales -- zum Beispiel über eine Verbindung -- gemessen
wird. Dadurch kann der eigentliche Durchsatz noch kleiner werden.
Das rührt daher, dass eine Verbindung ein Protokoll verwendet, das
einen gewissen Overhead erzeugt. 

Achtung: es wird oft der Begriff Bandbreite oft synonym zu Durchsatz
verwendet!


\minisec{Latenz}

Latenz (engl. delay, latency) ist die Dauer, die eine Nachricht von
einem Ende des Kanales zu dem anderen Ende benötigt. Bei dem Kanal
kann es sich wiederum um den Übertragungskanal oder um einen logischen
Kanal handeln. Auf der Ebene des Übertragungskanales ist die Latenz
durch die Signalausbreitungsgeschwindigkeit bestimmt. Auf der Ebene
der logischen Kanäle müssen die Verzögerungen der Zwischenknoten und
die durch die Protokolle bedingten Verzögerungen hinzugezählt werden.
Die Signalausbreitungsgeschwindigkeit liegt in der Größenordnung der
Lichtgeschwindigkeit (also ca. $3.0\times10^{8}$ m/s): Bei Kupferkabel
ca. $2.3\times10^{8}$ m/s und bei Lichtwellenleiter ca $2.0\times10^{8}$
m/s. Die Laufzeit $t_{D}$ des Signals berechnet sich also als $t_{D}=s/v$
wobei $s$ die Distanz und $v$ die Signalausbreitungsgeschwindigkeit
ist. Die tatsächliche Verzögerung ensteht zwischen Senden des ersten
Bit und dem Empfangen des letzten Bit einer Nachricht berechnet sich
als $t_{L}=t_{D}+t_{M}+t_{W}$, wobei $t_{M}$ die Sendedauer der
Nachricht und $t_{W}$ die Summe aller Wartezeiten der Zwischenknoten
ist. Die Sendedauer $t_{M}$ berechnet sich als $t_{M}=N/R$, wobei
$N$ die Datenmenge in Bit und $R$ die Datenrate in Bit/s ist.

Betrachtet man auf dieser Ebene den Durchsatz TP, dann entsteht dieser
als $TP=N/(2t_{D}+2t_{W}+N/R)$. Das Doppelte der Laufzeit des Signales
-- also $2t_{D}$ -- wird auch als Round-Trip-Time (RTT) bezeichnet.
D.h. die RTT gibt an wie lange eine Nachricht von dem Sender zum Empfänger
und wieder zurück benötigt. Eine etwaige Verarbeitungszeit beim Empfänger
ist hiermit noch nicht eingerechnet.

Es ist wieder zu beachten, dass die Begriffe in Abhängigkeit der gewählten
Abstraktion eine verschiedene Bedeutung aufweisen.


\minisec{Verzögerung-Bandbreite-Produkt}

Stellen wir uns vor, dass auf einem Übertragungskanal einer direkten
Verbindung permanent gesendet wird, dann gibt das Verzögerung-Bandbreite-Produkt
(engl. bandwidth-delay product) die Anzahl der Bits an, die in dem
Kanal gespeichert sind: Wird ein Bit beim Sender abgeschickt, dann
erreicht dieses den Empfänger nach der Zeit $t_{D}$. Innerhalb dieser
Zeitspanne befinden sich als $t_{D}\cdot R$ Bits auf der Leitung.

Betrachtet man eine Leitung mit einer Datenrate R von 10MBit/s sowie
einer Verzögerung $t_{D}$ von 50ms, dann sind immer $50\times10^{-3}s\times10\times10^{6}\mathit{Bit}/s=500\times10^{3}\mathit{Bit}$
in der Leitung gespeichert. Es handelt sich also um ca. 61KB.

Aufpassen muss man wie die Größenangaben Kilo, Mega, Giga in der Informatik
und im speziellen in der Netzwerktechnik verwendet werden: Prinzipiell
kann ein Kilo entweder 1000 oder 1024 also entweder $10^{3}$ oder
$2^{10}$ bedeuten! Warum ist das in der Netzwerktechnik besonders
zu beachten? Die Angaben für die Bandbreite wird wie schon besprochen
in Hz -- also einer physikalischen Größe -- angegeben. Daraus resultiert,
dass ein kHz also 1000Hz sind. Wird jedoch von KB gesprochen, dann
handelt es sich nicht um eine Größe aus der Physik sondern um eine
aus der Informatik. Dementsprechend wird unter einem KB also 1024
Byte verstanden.


\section{OSI Referenzmodell}

Die Schichtenbildung spielt bei verteilten Systemen und im speziellen
in der Netzwerktechnik eine große Rolle. Die ISO (International Organization
for Standardization) ist die wichtigste internationale Normungsorganisation.
Sie gibt allgemein anwendbare Normen heraus wie z.B. für Währungscodes,
Ländercodes oder die bekannten SI-Einheiten für physikalische Größen,
aber auch wichtige Normen für die Informatik, wie z.B. die Zeichencodes
(ISO-8859-15 oder UCS wie der UNICODE bei der ISO genannt wird). Für
die Rechnernetze ist jedoch das OSI Referenzmodell der wichtigste
Standard. OSI steht für ,,Open Systems Interconnection'' und ist
ein Referenzmodell für die Kommunikation zwischen offenen Systemen.
Offen bedeutet in diesem Fall, dass sich diese Systeme an gemeinsame
Standards halten, sodass eine Zusammenarbeit unabhängig von konkreten
Hard- und Softwarekomponenten möglich ist, solange sich diese Komponenten
an diese Standards halten.

Das OSI Referenzmodell wurde herangezogen, um konkrete Systeme auf
dieser Basis zu entwickeln, die sich jedoch hauptsächlich nur in der
Telekommunikationstechnologie etabliert konnten. Das liegt daran,
dass es sich um ein sehr umfangreiches Modell handelt, das einen hohen
Aufwand bei der Implementierung bedeutet. Außerdem waren diese ersten
Systeme nicht besonders effizient, nicht fehlerfrei und auch nicht
miteinander kompatibel. Ein anderer, vielleicht der wichtigste, Grund
liegt darin, dass das Internet mit der Technologie TCP/IP vorherrschend
im Einsatz ist und sich demzufolge durchgesetzt hat.

Heute wird das OSI Referenzmodell hauptsächlich dafür herangezogen
die Grundlagen und das Verständnis für Netzprotokolle zu vermitteln.
In diesem Sinne wird das OSI Modell hier beschrieben. Im Teil \vref{par:tcpip}
wird gezeigt wie das TCP/IP Modell auf das OSI Modell abgebildet wird
und welche die Unterschiede zwischen dem TCP/IP Modell und dem OSI
Modell existieren.


\subsection{Schichtenbildung\label{sec:layers}}

Es handelt sich beim OSI Modell um eine Hierarchie von 7 Schichten.
Jede dieser Schichten besitzt eine Schnittstelle, die von der darüberliegenden
Schicht verwendet werden kann und eine Schnittstelle, die von der
darunterliegenden Schicht verwendet werden kann. Diese Hierarchie
ist strikt. Das bedeutet, dass eine beliebige Schicht nur genau auf
die Funktionen der direkt unterliegenden Schicht zugreifen kann.

Warum eine Hierarchie? Wenn man sich die vielfältigen Aufgaben vor
Augen führt, die ein verteiltes System zu erfüllen hat, dann erkennt
man, dass es sich bei einer Netzwerksoftware um ein komplexes Gebilde
handelt. Wie schon erwähnt, ist es eine Möglichkeit mit Komplexität
umzugehen, indem eine Hierarchie von Abstraktionen gebildet wird.

An Aufgaben fallen für die Netzwerksoftware zum Beispiel an:
\begin{itemize}
\item Sicherstellung, dass auf einer Punkt-zu-Punkt Übertragungsstrecke
die Daten fehlerfrei übertragen werden.
\item Bereitstellung von Adressen, um Knoten identifizieren zu können.
\item Vermittlung und Wegsuche über mehrere Teilnetze hinweg.
\item Sicherstellung der Vollständigkeit und der Reihenfolge der einzelnen
Informationsblöcke.
\item Vergabe von Namen, die auf Adressen abgebildet werden und für den
Benutzer aussagekräftig sind.
\item Auf- und Abbau von Verbindungen.
\item Auf- und Abbau von Sitzungen.
\item Umwandlung von Datenrepräsentationen.
\item Bereitstellung von Diensten für Anwendungen wie z.B. Dateiübertragung.
\end{itemize}
Auf Grund dieser vielfältigen Aufgaben wurde eine Hierarchie von 7
Schichten gewählt, die jeweils eine bestimmte Funktion erfüllen. Diese
Struktur mit den 7 Schichten ist in Abbildung \vref{fig:osi_layers}
zu sehen.

%
\begin{figure}[h]
\centering

\includegraphics[bb=0bp 0bp 77mm 45mm,clip]{foundations/osi_layers}

\caption{\label{fig:osi_layers}OSI Schichtenmodell}

\end{figure}


Die Funktionen der einzelnen Schichten werden in den nachfolgenden
Abschnitten beschrieben.

Zwei Netzwerksprozesse kommunizieren so miteinander, dass jeder Prozess
-- also jedes laufende Anwendungsprogramm -- ausschließlich direkten
Kontakt mit der obersten Schicht -- der Anwendungsschicht -- aufnimmt.
Diese Anwendungsschicht verwendet zur weiteren Erfüllung ihrer Funktionen
die direkt darunterliegende Schicht. Jede einzelne Schicht verwendet
ihrerseits jeweils nur die direkt darunterliegende Schicht. Das wird
solange fortgeführt bis die unterste Schicht -- die Schicht 1 -- erreicht
ist. Diese Schicht ist die Bitübertragungsschicht, da auf dieser Ebene
die eigentliche Übertragung der Bits in Form von Signale stattfindet.
Danach wird beim Kommunikationspartner die Hierarchie der Schichten
von unten nach oben durchlaufen. Bei der Antwort wird der gleiche
Weg zurückgenommen. Dieser Vorgang ist in Abbildung \vref{fig:communication_layers}
dargestellt.

%
\begin{figure}[h]
\centering

\includegraphics[bb=0bp 0bp 105mm 9cm,clip]{foundations/osi_communication}

\caption{\label{fig:communication_layers}Kommunikation zwischen den Schichten
im OSI Modell}

\end{figure}



\subsection{Protokollhierarchie\label{sec:protocol_hierarchy}}

Meistens ist es so, dass die Prozesse auf verschiedenen Knoten im
Netz laufen. Damit handelt es sich notwendigerweise auch um verschiedene
Ausprägungen der Netzwerksoftware. Eine Schicht einer auf einem Knoten
installierten Netzsoftware wird in diesem Zusammenhang als Instanz
einer Schicht bezeichnet. In diesem Sinne kommunizieren zwei Instanzen
einer Ebene untereinander mittels eines Protokolles. Da die eigentlichen
Signale nur über die physikalische Übertragungsstrecke übertragen
werden können, findet die Kommunikation -- wie oben beschrieben --
über den Umweg der darunterliegenden Instanzen statt. Dadurch entsteht
eine Protokollhierarchie, auch Protokollstack genannt (siehe Abbildung
\vref{fig:osi_protocol_hierarchy}).

%
\begin{figure}[h]
\centering

\includegraphics[bb=0bp 0bp 120mm 8cm,clip]{foundations/osi_protocol_hierarchy}

\caption{\label{fig:osi_protocol_hierarchy}Protokollhierarchie der 7 OSI Schichten}

\end{figure}


Eine beliebige benannte Schicht wird in der OSI Nomenklatur als (N)-Schicht
bezeichnet, wobei N die Werte 1 bis 7 annehmen kann.


\subsection{Nachrichten zwischen Schichten\label{sec:messages_layers}}

Die eigentliche Kommunikation wird so durchgeführt, dass jeder Informationsblock,
der nach unten an die unterliegende Instanz gegeben wird, in einen
Umschlag (engl. envelope) verpackt wird, der zusätzliche Informationen
beinhaltet. Bei diesem Umschlag handelt es sich um einen Vorspann
(engl. header) und manchmal auch um einen Nachspann (engl. trailer).
Beim Prozess des Kommunikationspartners wird dieser Umschlag von der
Partnerinstanz entfernt und der so erhaltene Informationsblock an
die obenliegende Instanz weitergereicht. Der Rückweg wird wieder analog
behandelt (siehe Abbildung \vref{fig:osi_messages_layers}).

%
\begin{figure}[h]
\centering

\includegraphics[bb=0bp 0bp 120mm 9cm,clip]{foundations/osi_messages_layers}

\caption{\label{fig:osi_messages_layers}Nachrichtenfluss zwischen den 7 OSI
Schichten}

\end{figure}


Die grau hinterlegten Teile der Datenblöcke sind Teile des Umschlags.
Bei TCP/IP wird ein Trailer nur auf Schicht 2 verwendet. In Abbildung
\vpageref{fig:osi_messages_layers} wurde aus diesem Grund nur in
der Schicht 2 ein Trailer eingezeichnet.

Diese Informationsblöcke, die zwischen den einzelnen Schichten ausgetauscht
werden, sind die eigentlichen Nachrichten, die zwischen je zwei Instanzen
einer Schicht im Zuge des gemeinsamen Protokolls ausgetauscht werden.
Dabei haben sich teilweise je nach Schicht eigene Bezeichnungen etabliert:
\begin{itemize}
\item Auf der Schicht 2 wird von einem Rahmen (engl. frame) gesprochen.
Handelt es sich um kurze Rahmen mit fester Größe, dann werden diese
Rahmen als Zellen (engl. cell) bezeichnet.
\item In der Schicht 3 wird von Datagrammen (engl. datagram) oder auch von
Paketen (engl. packet) gesprochen.
\item Im Kontext von TCP werden die Nachrichten Segmente (engl. segment)
genannt. Bei UDP wird ebenfalls von Datagrammen gesprochen.
\item Auf den restlichen Schichten 5 bis 7 bzw. als Überbegriff wird der
Begriff Nachricht (engl. message) verwendet.
\end{itemize}
Nachrichten im Sinne der Schichten 2-4 sind dadurch charakterisiert,
dass sie eine festgelegte maximale Größe aufweisen. Dadurch unterscheiden
sie sich von den Nachrichten, die direkt zwischen den Anwendungen
ausgetauscht werden, die keinerlei Einschränkung bzgl. der Größe unterliegen.


\subsection{Protokollmechanismen}

In den einzelnen Schichten gibt es Funktionen, die bzgl. einer Abstraktion
vergleichbar sind. Diese Funktionen werden als Protokollmechanismen
bezeichnet. Diejenigen Funktionen, die spezifisch für eine jeweilige
Schicht sind, werden dann im Abschnitt \vref{sec:osi_layers} beschrieben.


\subsubsection{Protokollauswahl}

Die Auswahl eines Protokolles (engl. protocol selection) bzw. die
Identifizierung (engl. identification) ist eine der ersten Aufgaben
beim Kommunikationsbeginn. Öfters ist es so, dass zwischen zwei Kommunikationspartnern
oder spezieller in einer Schicht mehrere Protokolle zur Verfügung
stehen. Eines dieser Protokolle muss zur Kommunikation ausgewählt
werden. Dazu muss es natürlich identifiziert, also benannt werden.

Im Laufe der Lebenszeit eines Systemes ist es sehr wahrscheinlich,
dass das Protokoll an die laufenden Änderungen angepasst werden muss
(Protokollevolution). D.h. das Protokoll wird in mehreren Versionen
vorliegen und es ist die Auswahl einer konkreten Version (engl. protocol
version selection) notwendig.

Diese Auswahl eines geeigneten Protokolles bzw. einer speziellen Version
muss zwischen den beiden Kommunikationspartnern ausgehandelt werden
(engl. negotiation mechanism).


\subsubsection{Verbindungen}

Der Aufbau einer Verbindung (engl. connection establishment), der
Transfer der Daten und der Abbau einer Verbindung (engl. connection
release) sind die grundlegenden Elemente im Lebenszyklus einer Verbindung.
Allgemein verbindet eine Verbindung zwei Kommunikationspartner, bei
denen es sich wiederum speziell um Instanzen von Schichten handeln
kann.

Eine Verbindung in einer (N)-Schicht kann mittels einer Verbindung
auf der (N-1)-Schicht oder verbindungslos auf der (N-1)-Schicht realisiert
werden. Eine verbindungslose Kommunikation auf einer (N)-Schicht kann
verbindungsorientiert oder verbindungslos mittels der (N-1)-Schicht
realisiert werden. Es ergeben sich daher 4 verschiedene Möglichkeiten.

Abweichend vom normalen Datentransfer ist es manchmal sinnvoll, Daten
vorrangig auszuliefern. Dies wird als Vorrang-Datentransfer (engl.
expedited data transfer) bezeichnet.

Zusätzlich zum normalen Abbau einer Verbindung gibt es auch einen
speziellen Verbindungsabbruch (engl. abort). Dieser ist dadurch gekennzeichnet,
dass ausstehende Übertragungen nicht mehr durchgeführt werden, während
bei einem normalen Verbindungsabbau diese ausstehenden Übertragungen
sehr wohl noch durchgeführt werden.

Manche Dienste erfordern eine Zurücksetzfunktion (engl. reset), die
den Dienst oder im Speziellen die Verbindung in einen vordefinierten
Zustand zurücksetzen. Das kann notwendig werden, wenn das Protokoll
von einem Partner nicht mehr eingehalten wurde. Dadurch kann es zu
einem Verlust oder zu einer Duplizierung von Daten kommen.

D.h. man kann zwischen verbindungsorientierten (engl. connection-oriented)
und verbindungslosen (engl. connectionless) Protokollen unterscheiden:
\begin{itemize}
\item Verbindungsloses~Protokoll

\begin{itemize}
\item effizient
\item wenn Netzwerk relativ zuverlässig ist (wie in einem LAN), d.h. solange
Pakete nicht verloren gehen oder beschädigt werden.


Beispiel: Wenn keine Antwort kommt, dann muss z.B. der Client nochmals
schicken. Problem: ,,Überweise 10.000 Euro von meinem Konto'' sollte
nicht nochmals gesendet werden. D.h. die Anforderung nochmals zu senden
macht nur in bestimmten Fällen Sinn.

\end{itemize}
\item Verbindungsorientiertes~Protokoll

\begin{itemize}
\item Overhead, da Einrichten und Abbauen einer Verbindung relativ kostspielig
ist.
\item wenn Netzwerk nicht zuverlässig ist (wie in einem WAN).
\end{itemize}
\end{itemize}
Prinzipiell kann auch noch zwischen einem \emph{zustandsbehafteten}
und einem \emph{zustandslosen} Protokoll unterschieden werden. D.h.
hängen im Protokoll die Nachrichten vom Zustand der vorhergehend gesendeten
Nachrichten ab oder nicht.

http ist ein typisch zustandsloses Protokoll, das über ein verbindungsorientiertes
Transportprotokoll übertragen wird. Man beachte die verschiedenen
Protokollhierarchieebenen, die hier eine Rolle spielen.

Eine \emph{Sitzung} (Session) ist charakterisiert, dass es
\begin{itemize}
\item eine feste Beziehung zwischen den kommunizierenden Prozessen auf Anwendungsebene
mit vereinbarten Eigenschaften (Namen, Ressourcen, Charakteristika,...)
gibt.
\item einen gemeinsamen Zustand zwischen den kommunzierenden Prozessen während
der Session gibt. 
\item meist auch Mechanismen der Authentifikation und Autorisierung gibt.
\end{itemize}
D.h. eine Session kann nur mit einem zustandsbehafteten Protokoll
aufgebaut werden. Setzt man diese Aussage in den Zusammenhang mit
Sessions im Web, dann kann man einwerfen, dass es sich bei http um
ein zustandsloses Protokoll handelt. Das ist richtig, deshalb wird
in solch einem Fall der Zustand explizit zwischen den Kommunikationspartnern
bei jedem Nachrichtenaustausch übertragen. Oft wird jedoch nicht der
gesamte Zustand (vgl. Warenkorb) übertragen, sondern nur eine eindeutige
Information unter der der Zustand im Server gespeichert ist.


\subsubsection{Sicherstellung einer zuverlässige Übertragung}

Zur Fehlererkennung (engl. error detection) und Fehlerkorrektur (engl.
error correction) gibt es verschiedene Möglichkeiten.

Ein Verlust einer Nachricht kann erkannt werden, wenn nach dem Absenden
einer Nachricht innerhalb einer vorgegebenen Zeitspanne (engl. timeout)
keine positive Quittierung (engl. acknowledgement oder kurz ACK) empfangen
wird. Ein ACK kann entweder als eigene Nachricht oder als Huckepack-Quittierung
(engl. piggy back acknowledgement) gesendet werden.

Zur Erkennung von Fehlern innerhalb einer Nachricht werden Prüfsummen
(engl. check\-sum) herangezogen. Wird in einer Nachricht ein Fehler
erkannt, dann gibt es die folgenden Möglichkeiten: 
\begin{itemize}
\item Die Nachricht wird verworfen.
\item Die Nachricht wird verworfen und es wird eine negative Quittierung
(engl. negative acknowledgment oder kurz NACK) gesendet.
\item Die Nachricht kann automatisch korrigiert werden.
\end{itemize}
Allgemein: Die positive Quittierung dient als Bestätigung für das
Erreichen eines bestimmten Zustandes. Bei Nichterreichen eines bestimmten
Zustandes kann analag dazu eben eine negative Quittierung gesendet.

Damit die Reihenfolge der Nachrichten innerhalb eines Protokolle sichergestellt
werden kann, werden Sequenznummern verwendet (engl. sequencing). Diese
Sequenznummern werden auch bei der Anpassung der Systemleistung (siehe
Abschnitt \vref{sec:performance_system}) verwendet.


\subsubsection{Anpassung an die Länge\label{sec:segmenting}}

Wie in schon Abschnitt \ref{sec:messages_layers} beschrieben ist
es oft so, dass die maximale Größe einer Nachricht je Schicht unterschiedlich
sein kann. Dadurch ergibt sich die Notwendigkeit die Größen der Nachrichten,
die zwischen einer (N)-Schicht und der (N-1)-Schicht ausgetauscht
werden anzupassen.

Den Vorgang des Aufteilens einer Nachricht auf mehrere Nachrichten
geringerer Größe zum Zwecke der Anpassung an die geringere maximale
Größe der anderen Schicht nennt man Segmentierung (engl. segmenting).
Den umgekehrten Vorgang des Zusammensetzens mehrere kleinerer Nachrichten
zu einer größen Nachricht nennt man Reassemblierung (engl. reassembling).


\subsubsection{Anpassung an die Systemleistung\label{sec:performance_system}}

Der Empfänger von Nachrichten muss vor einer Überlastung durch den
Sender geschützt werden. Dies nennt man \emph{Flusskontrolle} (engl.
flow control).

Der Schutz eines Netzes vor Überlastung durch die von allen Sendern
gesendeten Nachrichten nennt \emph{Überlaststeuerung} (engl. congestion
control).


\subsubsection{Anpassung der Übertragungsleistung}

Will man eine Übertragungsleistung einer Verbindung mehreren Kommunikationspartner
zur Verfügung stellen, spricht man von Multiplexen (engl. multiplexing).
D.h. allgemein wird eine (N-1)-Verbindung -- eine Verbindung in einer
(N-1)-Schicht -- für mehrere (N)-Verbindungen nutzbar gemacht. Den
analogen Vorgang die (N-1)-Verbindung wieder auf die (N)-Verbindungen
aufzuteilen heißt Demultiplexen (engl. demultiplexing).

Wird allerdings eine Übertragungsleistung gefordert, die nicht durch
eine Verbindung der unterliegenden Schicht erfüllt werden kann, dann
müssen mehrere Verbindungen dieser untenliegenden Schicht verwendet
werden. Dazu wird eine (N)-Verbindung auf mehrere (N-1)-Verbindungen
aufgeteilt (engl. splitting) und beim Empfänger werden analog dazu
die (N-1)-Verbindungen wieder zu der (N)-Verbindung zusammengesetzt
(engl. recombining).


\subsubsection{Dienstgüte}

Die Verhandlung einer bestimmten Dienstgüte (engl. quality of service
oder kurz QoS) fasst alle Parameter zusammen, die eine Verbindung
oder eine einzelne Nachrichtenübermittlung betreffen. Diese Parameter
werden beim Aufbau der Verbindung ausverhandelt (verbindungsorientiert)
oder bei jeder einzelnen Nachrichtenübermittlung (verbindungslos).
D.h. der Sender fordert Parameter an, die der Empfänger voll oder
teilweise akzeptiert.

Beispiele für solche Parameter (nach Attributen aufgeschlüsselt):
\begin{description}
\item [{Leistung}]~

\begin{description}
\item [{Durchsatz}] Unter dem Durchsatz (engl. throughput) wird die zugesicherte
Menge an Benutzerdaten pro Zeiteinheit verstanden, die übertragen
werden.
\item [{Übertragungsverzögerung}] Die Übertragungsverzögerung (engl. transmission
delay, latency) gibt die maximale Zeitdauer zwischen dem Absenden
der Anfrage und der Ankunft beim Emfänger an.
\item [{Schwankung~der~Übertragungsverzögerung}] (engl. jitter) ist die
Varianz der Latenzzeit von Datenpaketen. Dieser Effekt ist insbesondere
bei Multimedia-Anwendungen (zum Beispiel Audio-Streaming und IP-Telefonie)
unerwünscht.
\item [{Verbindungaufbauverzögerung}] (engl. connection establishment delay)
beschreibt die maximale Zeit die vergeht bis eine Verbindung aufgebaut
ist.
\item [{Verbindungsbeendigungsverzögerung}] (engl. connection release delay)
analog zur Verbindungsaufbauverzögerung.
\item [{Priorität}] Die Priorität (engl. priority) des Datentransfers gibt
an inwieweit vorrangig Daten übertragen werden können.
\end{description}
\item [{Zuverlässigkeit}]~

\begin{description}
\item [{Vollständigkeit}] Angabe inwieweit eine Zusicherung gegeben werden
kann, dass die Nachrichten zumindest einmal beim Kommunikationspartner
ankommen bzw. inwieweit es zu Verlust von Nachrichten kommt (engl.
probability of loss).
\item [{Fehlerraten}] Wahrscheinlichkeit der Datenveränderung (engl. probability
of corruption).
\item [{Eindeutigkeit}] Vermeidung der Duplizierung von Nachrichten (engl.
probability of duplication).
\item [{Reihenfolge}] Einhaltung der Reihenfolge der Nachrichten (engl.
probability of out of sequence delivery).
\item [{Garantien}] Angabe inwieweit die Leistungsparameter erbracht werden
können. Das meist genutzte Prinzip ,,best effort'' gibt lediglich
an, dass die Werte so gut wie möglich eingehalten werden, aber keine
Garantie angegeben werden kann. Andere Angaben werden oft mit Wahrscheinlichkeiten
beziffert, sofern andere Bedingungen -- wie z.B. funktionierende Software
und Hardware -- erfüllt sind.
\end{description}
\item [{Sicherheit}] Darunter werden alle Maßnahmen angegeben, die die
Sicherheit der Kommunikation sicherstellen können (siehe Teil \ref{par:security}).
\end{description}

\subsection{Schichten\label{sec:osi_layers}}


\subsubsection{Schicht 1 -- Bitübertragungsschicht}

In der Bitübertragungsschicht (engl. physical layer) werden die physikalischen
Eigenschaften der Übertragungsstrecke beschrieben. Dies inkludiert
das Übertragungsmedium (siehe Abschnitt \vref{sec:transmission_media})
wie z.B. ein Kabel, das Übertragungsverfahren (siehe Abschnitt \vref{sec:transmission_methods})
und den Übergang auf das Übertragungsmedium wie z.B. Steckverbindungen.
Im Detail handelt es sich um die elektrischen, mechanischen, optischen
oder elektromagnetischen Spezifikationen.

Als Erweiterung zum OSI Modell kann die Bitübertragungsschicht noch
weiter unterteilt werden in:
\begin{itemize}
\item Media~Independent~Interface (abgekürzt mit MII), bietet die einheitliche
unterschiedlicher Übertragungsmedien.
\item Physical~Media~Dependent (abgekürzt mit PMD) ist für den eigentlichen
Zugriff auf das Übertragungsmedium zuständig. Z.B. kann als Übertragungsmedium
entweder eine verdrillte Zweitdrahtleitung oder ein Koaxialkabel verwendet
werden.
\end{itemize}

\subsubsection{Schicht 2 -- Sicherungsschicht }

Die Hauptaufgabe der Sicherungsschicht (engl. data link layer) liegt
in der fehlerfreien Punkt-zu-Punkt Übertragung ganzer Rahmen zwischen
\emph{benachbarten Stationen}. Diese Stationen können entweder direkt
miteinander oder über einen Bus verbunden sein.

Im Falle eines Bussystems muss jeder Knoten auch eine eigene Adresse
haben, die MAC-Adresse (engl. media access control) genannt wird.
Es handelt sich dabei um eine Hardwareadresse, die direkt dem Netzwerkadapter
des Knotens zugeordnet ist. Als solches muss diese MAC-Adresse zumindest
innerhalb des Bussystems eindeutig sein. Häufig sind diese MAC-Adressen
jedoch global eindeutig vergeben (siehe Abschnitt \vref{sec:ethernet}).

Als Erweiterung zum OSI Modell kann die Sicherungsschicht noch weiter
unterteilt werden:
\begin{description}
\item [{Logical~Link~Control}] (abgekürzt mit LLC), die die eigentlichen
Funktionen der Schicht 2 abdeckt.
\item [{Media~Access~Control}] (abgekürzt mit MAC), die den Zugriff auf
das Übertragungsmedium steuert.
\end{description}

\subsubsection{Schicht 3 -- Vermittlungsschicht}

In der Vermittlungsschicht oder auch Netzwerksschicht (engl. network
layer) genannt werden hauptsächlich die Nachrichten weitervermittelt.
Die Übertragung geht über das gesamte Netzwerk hinweg und schließt
das Weiterleiten zwischen den Netzknoten mit ein. D.h. eine Nachricht
wird von einem (End-)Knoten -- unter Umständen über mehrere Zwischenknoten
hinweg -- zu einem anderen (End-)Knoten übermittelt (Ende-zu-Ende,
engl. end-to-end). Ebenfalls auf dieser Ebene sind die Netzadressen
angesiedelt, die über das gesamte Netz eindeutig vergeben werden müssen.


\subsubsection{Schicht 4 -- Transportschicht}

Die Transportschicht (engl. transport layer) stellt Verbindungen zwischen
den kommunizierenden Netzprozessen als Ende-zu-Ende Verbindungen zur
Verfügung. D.h., dass auf dieser Ebene wird einerseits das Konzept
der Verbindungen und andererseits werden Mechanismen für eine Adressierung
der Netzprozesse als Kommunikationspartner zur Verfügung gestellt.
Wie schon erwähnt beinhaltet das Konzept der Verbindung auch, dass
Nachrichten vollständig, fehlerfrei, in der richtigen Reihenfolge
und genau einmal beim Empfänger eintreffen. Dafür ist ebenfalls die
Transportschicht zuständig.


\subsubsection{Schicht 5 -- Sitzungsschicht}

In der Sitzungsschicht (engl. session layer) wird die Steuerung der
Kommunikation zwischen den kommunizierenden Netzprozessen gesteuert.
Sie unterstützt eine Dialogsteuerung, um zu verfolgen welche Partei
gerade spricht und stellt Funktionen für die Synchronisierung bereit.
Dazu wird ebenfalls eine Verbindung auf dieser Ebene realisiert, die
auch Wiederaufsetzpunkte (engl. check point) einsetzt, um die Kommunikation
bei einem Synchronisationsverlust zwischen Sender und Empfänger wieder
kontrolliert fortsetzen zu können.


\subsubsection{Schicht 6 -- Darstellungsschicht}

Die Darstellungsschicht (engl. presentation layer) ist für die korrekte
Umwandlung unterschiedlicher Datenformate (z.B. ASCII in UTF-8, little-endian
in big-endian oder allgemeine Umwandlung von Zahlendarstellungen)
zuständig. Ebenfalls zählen Datenkompression und Verschlüsselung zu
den Aufgaben dieser Ebene.


\subsubsection{Schicht 7 -- Anwendungsschicht}

Als oberste Schicht im OSI Modell stellt die Anwendungsschicht (engl.
application layer) die Schnittstelle zum Netzprozess dar. Die Aufgaben
dieser Schicht liegen im Bereitstellen von Diensten, die oft von Netzprozessen
benötigt werden, wie z.B. Datenübertragung, E-Mail, oder entferntes
Anmelden (engl. remote login).
